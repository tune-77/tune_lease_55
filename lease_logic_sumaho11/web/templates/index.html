{% extends "base.html" %}
{% block title %}新規審査{% endblock %}
{% block content %}
<div class="mb-8">
  <h1 class="text-2xl font-bold text-slate-800 mb-1">新規審査</h1>
  <p class="text-slate-600">必須項目（売上高・総資産）を入力して判定を実行してください。単位は<strong>千円</strong>で、1千円単位で入力できます。</p>
  <p class="mt-3">
    <a href="{{ url_for('visualization') }}" class="inline-block rounded-lg border-2 border-teal-500 bg-teal-50 px-4 py-2 text-sm font-semibold text-teal-700 hover:bg-teal-100">→ スコア可視化（Riemannian Credit Manifold）</a>
  </p>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, msg in messages %}
    <div class="mb-4 rounded-xl border border-amber-200 bg-amber-50 px-4 py-3 text-amber-800" role="alert">
      {{ msg }}
    </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<form action="{{ url_for('result') }}" method="post" class="space-y-6" novalidate>
  <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
    <h2 class="text-lg font-semibold text-teal-800 mb-4">財務データ（千円・1千円単位）</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div>
        <label for="nenshu" class="block text-sm font-medium text-slate-700 mb-1">売上高（千円） <span class="text-red-500">*</span></label>
        <input type="number" id="nenshu" name="nenshu" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="例: 500000">
      </div>
      <div>
        <label for="op_profit" class="block text-sm font-medium text-slate-700 mb-1">営業利益（千円）</label>
        <input type="number" id="op_profit" name="op_profit" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="例: 25000">
      </div>
      <div>
        <label for="total_assets" class="block text-sm font-medium text-slate-700 mb-1">総資産（千円） <span class="text-red-500">*</span></label>
        <input type="number" id="total_assets" name="total_assets" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="例: 300000">
      </div>
      <div>
        <label for="net_assets" class="block text-sm font-medium text-slate-700 mb-1">純資産（千円）</label>
        <input type="number" id="net_assets" name="net_assets" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="例: 120000">
      </div>
      <div>
        <label for="ord_profit" class="block text-sm font-medium text-slate-700 mb-1">経常利益（千円）</label>
        <input type="number" id="ord_profit" name="ord_profit" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="例: 22000">
      </div>
      <div>
        <label for="net_income" class="block text-sm font-medium text-slate-700 mb-1">当期純利益（千円）</label>
        <input type="number" id="net_income" name="net_income" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="例: 18000">
      </div>
    </div>
  </section>

  <section class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6">
    <h2 class="text-lg font-semibold text-teal-800 mb-4">業種・与信</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div class="sm:col-span-2">
        <label for="industry_sub" class="block text-sm font-medium text-slate-700 mb-1">業種（中分類）</label>
        <select id="industry_sub" name="industry_sub"
                class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500">
          {% for sub in industry_subs %}
          <option value="{{ sub }}">{{ sub }}</option>
          {% endfor %}
        </select>
      </div>
      <div>
        <label for="grade" class="block text-sm font-medium text-slate-700 mb-1">格付</label>
        <select id="grade" name="grade" class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500">
          <option value="1-3">1〜3</option>
          <option value="4-6">4〜6</option>
          <option value="要注意">要注意</option>
          <option value="無格付">無格付</option>
        </select>
      </div>
      <div>
        <label for="customer_type" class="block text-sm font-medium text-slate-700 mb-1">先方</label>
        <select id="customer_type" name="customer_type" class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500">
          <option value="既存先">既存先</option>
          <option value="新規先">新規先</option>
        </select>
      </div>
      <div>
        <label for="bank_credit" class="block text-sm font-medium text-slate-700 mb-1">銀行与信（千円）</label>
        <input type="number" id="bank_credit" name="bank_credit" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="0">
      </div>
      <div>
        <label for="lease_credit" class="block text-sm font-medium text-slate-700 mb-1">リース与信（千円）</label>
        <input type="number" id="lease_credit" name="lease_credit" min="0" step="1"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="0">
      </div>
      <div>
        <label for="contracts" class="block text-sm font-medium text-slate-700 mb-1">契約件数</label>
        <input type="number" id="contracts" name="contracts" min="0"
               class="w-full rounded-lg border border-slate-300 px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-teal-500"
               placeholder="0">
      </div>
    </div>
  </section>

  <div class="flex flex-col sm:flex-row gap-3 justify-end">
    <button type="submit"
            class="inline-flex items-center justify-center rounded-xl bg-teal-600 px-6 py-3 text-base font-medium text-white shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition">
      判定を実行
    </button>
    <a href="/" class="inline-flex items-center justify-center rounded-xl border border-slate-300 bg-white px-6 py-3 text-base font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition">
      クリア
    </a>
  </div>
</form>
{% endblock %}
